{"version":3,"file":"use-handle-favorite-DgTaOWZK.js","sources":["../../../src/renderer/features/shared/hooks/use-handle-favorite.ts"],"sourcesContent":["import { MutableRefObject, useCallback } from 'react';\n\nimport { VirtualInfiniteGridRef } from '/@/renderer/components/virtual-grid';\nimport { useCreateFavorite } from '/@/renderer/features/shared/mutations/create-favorite-mutation';\nimport { useDeleteFavorite } from '/@/renderer/features/shared/mutations/delete-favorite-mutation';\nimport { LibraryItem } from '/@/shared/types/domain-types';\nimport { ServerListItem } from '/@/shared/types/types';\n\ninterface HandleFavoriteProps {\n    gridRef: MutableRefObject<null | VirtualInfiniteGridRef>;\n    server: null | ServerListItem;\n}\n\nexport const useHandleFavorite = ({ gridRef, server }: HandleFavoriteProps) => {\n    const createFavoriteMutation = useCreateFavorite({});\n    const deleteFavoriteMutation = useDeleteFavorite({});\n\n    const handleFavorite = useCallback(\n        async (options: { id: string[]; isFavorite: boolean; itemType: LibraryItem }) => {\n            const { id, isFavorite, itemType } = options;\n            try {\n                if (isFavorite) {\n                    await deleteFavoriteMutation.mutateAsync({\n                        query: {\n                            id,\n                            type: itemType,\n                        },\n                        serverId: server?.id,\n                    });\n                } else {\n                    await createFavoriteMutation.mutateAsync({\n                        query: {\n                            id,\n                            type: itemType,\n                        },\n                        serverId: server?.id,\n                    });\n                }\n\n                const idSet = new Set(id);\n                gridRef.current?.updateItemData((data) =>\n                    idSet.has(data.id)\n                        ? {\n                              ...data,\n                              userFavorite: !isFavorite,\n                          }\n                        : data,\n                );\n            } catch (error) {\n                console.error(error);\n            }\n        },\n        [createFavoriteMutation, deleteFavoriteMutation, gridRef, server?.id],\n    );\n\n    return handleFavorite;\n};\n"],"names":["useHandleFavorite","gridRef","server","createFavoriteMutation","useCreateFavorite","deleteFavoriteMutation","useDeleteFavorite","useCallback","options","id","isFavorite","itemType","idSet","_a","data","error"],"mappings":"wDAaO,MAAMA,EAAoB,CAAC,CAAE,QAAAC,EAAS,OAAAC,KAAkC,CACrE,MAAAC,EAAyBC,EAAkB,EAAE,EAC7CC,EAAyBC,EAAkB,EAAE,EAwC5C,OAtCgBC,EAAA,YACnB,MAAOC,GAA0E,OAC7E,KAAM,CAAE,GAAAC,EAAI,WAAAC,EAAY,SAAAC,CAAa,EAAAH,EACjC,GAAA,CACIE,EACA,MAAML,EAAuB,YAAY,CACrC,MAAO,CACH,GAAAI,EACA,KAAME,CACV,EACA,SAAUT,GAAA,YAAAA,EAAQ,EAAA,CACrB,EAED,MAAMC,EAAuB,YAAY,CACrC,MAAO,CACH,GAAAM,EACA,KAAME,CACV,EACA,SAAUT,GAAA,YAAAA,EAAQ,EAAA,CACrB,EAGC,MAAAU,EAAQ,IAAI,IAAIH,CAAE,GACxBI,EAAAZ,EAAQ,UAAR,MAAAY,EAAiB,eAAgBC,GAC7BF,EAAM,IAAIE,EAAK,EAAE,EACX,CACI,GAAGA,EACH,aAAc,CAACJ,CAAA,EAEnBI,SAELC,EAAO,CACZ,QAAQ,MAAMA,CAAK,CAAA,CAE3B,EACA,CAACZ,EAAwBE,EAAwBJ,EAASC,GAAA,YAAAA,EAAQ,EAAE,CACxE,CAGJ"}