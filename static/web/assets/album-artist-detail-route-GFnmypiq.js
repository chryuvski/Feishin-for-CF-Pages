import{i as Mt,bl as $t,ab as Y,B as Yt,ac as wt,z as W,bu as Wt,r as S,b2 as N,bv as jt,aU as T,m as Ct,F as ft,I as H,aC as yt,bw as j,j as s,n as u,t as L,bp as w,M as x,bd as v,a5 as vt,aG as Vt,bx as Xt,by as Jt,bz as Kt,bA as _t,bB as Zt,bC as Qt,bD as ts,bE as ss,bF as as,W as es,a_ as E,bG as z,bH as ns,aI as is,s as Et,bI as Ut,bJ as os,bK as rs,bL as ds,T as G,bM as ls,bN as cs,S as ms,A as ps,bn as us,L as $}from"./index-qz_z9GmZ.js";import{L as gs,F as bs,S as Is}from"./library-background-overlay-CdEXqwMP.js";import{u as Bt,M as hs}from"./album-list-query-DRHfuUWa.js";import{u as y,a as As}from"./top-songs-list-query-vHKzxpfL.js";const Dt=Ut.div`
    position: relative;
    z-index: 0;
`,xs=Ut.div`
    display: flex;
    flex-direction: column;
    gap: 2rem;
    padding: 1rem 2rem 5rem;
    overflow: hidden;

    .ag-theme-alpine-dark {
        --ag-header-background-color: rgb(0 0 0 / 0%) !important;
    }
`,Ts=({background:D})=>{var Q,tt,st,at,et,nt,it,ot,rt,dt,lt,ct,mt,pt,ut,gt,bt,It,ht,At,xt;const{t:c}=Mt(),{artistItems:R,externalLinks:M,lastFM:C,musicBrainz:m}=$t(),{albumArtistId:h,artistId:a}=Y(),i=a||h,g=Yt(),p=wt(),n=W(),f=Wt(),[d,I]=S.useMemo(()=>{const e={},b={};for(const[k,B]of R.entries())e[B.id]=!B.disabled,b[B.id]=k+1;return[e,b]},[R]),t=y({query:{id:i},serverId:n==null?void 0:n.id}),_=`${N(T.LIBRARY_ALBUM_ARTISTS_DETAIL_DISCOGRAPHY,{albumArtistId:i})}?${jt({artistId:i,artistName:((Q=t==null?void 0:t.data)==null?void 0:Q.name)||""})}`,U=`${N(T.LIBRARY_ALBUM_ARTISTS_DETAIL_SONGS,{albumArtistId:i})}?${jt({artistId:i,artistName:((tt=t==null?void 0:t.data)==null?void 0:tt.name)||""})}`,o=Bt({options:{enabled:d.recentAlbums},query:{artistIds:[i],limit:15,sortBy:ft.RELEASE_DATE,sortOrder:Ct.DESC,startIndex:0},serverId:n==null?void 0:n.id}),r=Bt({options:{enabled:d.compilations&&(n==null?void 0:n.type)!==H.SUBSONIC},query:{artistIds:[i],compilation:!0,limit:15,sortBy:ft.RELEASE_DATE,sortOrder:Ct.DESC,startIndex:0},serverId:n==null?void 0:n.id}),l=As({options:{enabled:!!((st=t==null?void 0:t.data)!=null&&st.name)&&d.topSongs},query:{artist:((at=t==null?void 0:t.data)==null?void 0:at.name)||"",artistId:i},serverId:n==null?void 0:n.id}),O=S.useMemo(()=>yt([{column:j.ROW_INDEX,width:0},{column:j.TITLE_COMBINED,width:0},{column:j.DURATION,width:0},{column:j.ALBUM,width:0},{column:j.YEAR,width:0},{column:j.PLAY_COUNT,width:0},{column:j.USER_FAVORITE,width:0}]),[]),P={album:[{property:"name",route:{route:T.LIBRARY_ALBUMS_DETAIL,slugs:[{idProperty:"id",slugProperty:"albumId"}]}},{arrayProperty:"name",property:"albumArtists",route:{route:T.LIBRARY_ALBUM_ARTISTS_DETAIL,slugs:[{idProperty:"id",slugProperty:"albumArtistId"}]}}],albumArtist:[{property:"name",route:{route:T.LIBRARY_ALBUM_ARTISTS_DETAIL,slugs:[{idProperty:"id",slugProperty:"albumArtistId"}]}}]},A={album:{route:T.LIBRARY_ALBUMS_DETAIL,slugs:[{idProperty:"id",slugProperty:"albumId"}]},albumArtist:{route:T.LIBRARY_ALBUM_ARTISTS_DETAIL,slugs:[{idProperty:"id",slugProperty:"albumArtistId"}]}},F=S.useMemo(()=>{var e,b,k,B,Tt,Lt,Rt,St;return[{data:(e=o==null?void 0:o.data)==null?void 0:e.items,isHidden:!((k=(b=o==null?void 0:o.data)==null?void 0:b.items)!=null&&k.length)||!d.recentAlbums,itemType:u.ALBUM,loading:(o==null?void 0:o.isLoading)||o.isFetching,order:I.recentAlbums,title:s.jsxs(L,{align:"flex-end",children:[s.jsx(w,{order:2,weight:700,children:c("page.albumArtistDetail.recentReleases",{postProcess:"sentenceCase"})}),s.jsx(x,{compact:!0,component:v,to:_,uppercase:!0,variant:"subtle",children:c("page.albumArtistDetail.viewDiscography")})]}),uniqueId:"recentReleases"},{data:(B=r==null?void 0:r.data)==null?void 0:B.items,isHidden:!((Lt=(Tt=r==null?void 0:r.data)==null?void 0:Tt.items)!=null&&Lt.length)||!d.compilations||(n==null?void 0:n.type)===H.SUBSONIC,itemType:u.ALBUM,loading:(r==null?void 0:r.isLoading)||r.isFetching,order:I.compilations,title:s.jsx(w,{order:2,weight:700,children:c("page.albumArtistDetail.appearsOn",{postProcess:"sentenceCase"})}),uniqueId:"compilationAlbums"},{data:((Rt=t==null?void 0:t.data)==null?void 0:Rt.similarArtists)||[],isHidden:!((St=t==null?void 0:t.data)!=null&&St.similarArtists)||!d.similarArtists,itemType:u.ALBUM_ARTIST,order:I.similarArtists,title:s.jsx(w,{order:2,weight:700,children:c("page.albumArtistDetail.relatedArtists",{postProcess:"sentenceCase"})}),uniqueId:"similarArtists"}]},[_,(et=r==null?void 0:r.data)==null?void 0:et.items,r.isFetching,r==null?void 0:r.isLoading,(nt=t==null?void 0:t.data)==null?void 0:nt.similarArtists,d.compilations,d.recentAlbums,d.similarArtists,I.compilations,I.recentAlbums,I.similarArtists,(it=o==null?void 0:o.data)==null?void 0:it.items,o.isFetching,o==null?void 0:o.isLoading,n==null?void 0:n.type,c]),q=vt(),Ot=async e=>{p==null||p({byItemType:{id:[i],type:h?u.ALBUM_ARTIST:u.ARTIST},playType:e||q})},Pt=Vt(u.SONG,Xt),Ft=e=>{var b;!e.data||!(l!=null&&l.data)||p==null||p({byData:((b=l==null?void 0:l.data)==null?void 0:b.items)||[],initialSongId:e.data.id,playType:q})},V=Jt({}),X=Kt({}),kt=()=>{t!=null&&t.data&&(t.data.userFavorite?X.mutate({query:{id:[t.data.id],type:u.ALBUM_ARTIST},serverId:t.data.serverId}):V.mutate({query:{id:[t.data.id],type:u.ALBUM_ARTIST},serverId:t.data.serverId}))},J=(ot=t==null?void 0:t.data)==null?void 0:ot.albumCount,Nt=(J??1)>0?_t:_t.filter(e=>!e.id.toLowerCase().includes("play")),zt=Zt(u.ALBUM_ARTIST,Nt),Ht=(dt=(rt=l==null?void 0:l.data)==null?void 0:rt.items)==null?void 0:dt.slice(0,10),K=S.useMemo(()=>{var b;const e=(b=t==null?void 0:t.data)==null?void 0:b.biography;return!e||!d.biography?null:Qt(e)},[(lt=t==null?void 0:t.data)==null?void 0:lt.biography,d.biography]),qt=((mt=(ct=l==null?void 0:l.data)==null?void 0:ct.items)==null?void 0:mt.length)&&d.topSongs,Gt=(pt=t==null?void 0:t.data)!=null&&pt.genres?((ut=t==null?void 0:t.data)==null?void 0:ut.genres.length)!==0:!1,Z=(gt=t==null?void 0:t.data)==null?void 0:gt.mbz;return(t==null?void 0:t.isLoading)||(n==null?void 0:n.type)===H.NAVIDROME&&d.topSongs&&(l==null?void 0:l.isLoading)?s.jsx(Dt,{ref:g.ref}):s.jsxs(Dt,{ref:g.ref,children:[s.jsx(gs,{$backgroundColor:D}),s.jsxs(xs,{children:[s.jsxs(L,{spacing:"md",children:[s.jsx(ts,{disabled:J===0,onClick:()=>Ot(q)}),s.jsxs(L,{spacing:"xs",children:[s.jsx(x,{compact:!0,loading:V.isLoading||X.isLoading,onClick:kt,variant:"subtle",children:(bt=t==null?void 0:t.data)!=null&&bt.userFavorite?s.jsx(ss,{color:"red",size:20}):s.jsx(as,{size:20})}),s.jsx(x,{compact:!0,onClick:e=>{t!=null&&t.data&&zt(e,[t.data])},variant:"subtle",children:s.jsx(es,{size:20})})]})]}),s.jsxs(L,{spacing:"md",children:[s.jsx(x,{compact:!0,component:v,to:_,uppercase:!0,variant:"subtle",children:c("page.albumArtistDetail.viewDiscography")}),s.jsx(x,{compact:!0,component:v,to:U,uppercase:!0,variant:"subtle",children:c("page.albumArtistDetail.viewAllTracks")})]}),Gt?s.jsx(E,{component:"section",children:s.jsx(L,{spacing:"sm",children:(ht=(It=t==null?void 0:t.data)==null?void 0:It.genres)==null?void 0:ht.map(e=>s.jsx(x,{compact:!0,component:v,radius:"md",size:"md",to:N(f,{genreId:e.id}),variant:"outline",children:e.name},`genre-${e.id}`))})}):null,M&&(C||m)?s.jsx(E,{component:"section",children:s.jsxs(L,{spacing:"sm",children:[C&&s.jsx(x,{compact:!0,component:"a",href:`https://www.last.fm/music/${encodeURIComponent(((At=t==null?void 0:t.data)==null?void 0:At.name)||"")}`,radius:"md",rel:"noopener noreferrer",size:"md",target:"_blank",tooltip:{label:c("action.openIn.lastfm")},variant:"subtle",children:s.jsx(bs,{size:25})}),m&&Z?s.jsx(x,{compact:!0,component:"a",href:`https://musicbrainz.org/artist/${Z}`,radius:"md",rel:"noopener noreferrer",size:"md",target:"_blank",tooltip:{label:c("action.openIn.musicbrainz")},variant:"subtle",children:s.jsx(Is,{size:25})}):null]})}):null,s.jsxs(z,{children:[K?s.jsx(z.Col,{order:I.biography,span:12,children:s.jsxs(E,{component:"section",maw:"1280px",children:[s.jsx(w,{order:2,weight:700,children:c("page.albumArtistDetail.about",{artist:(xt=t==null?void 0:t.data)==null?void 0:xt.name})}),s.jsx(ns,{dangerouslySetInnerHTML:{__html:K}})]})}):null,qt?s.jsx(z.Col,{order:I.topSongs,span:12,children:s.jsxs(E,{component:"section",children:[s.jsx(L,{noWrap:!0,position:"apart",children:s.jsxs(L,{align:"flex-end",noWrap:!0,children:[s.jsx(w,{order:2,weight:700,children:c("page.albumArtistDetail.topSongs",{postProcess:"sentenceCase"})}),s.jsx(x,{compact:!0,component:v,to:N(T.LIBRARY_ALBUM_ARTISTS_DETAIL_TOP_SONGS,{albumArtistId:i}),uppercase:!0,variant:"subtle",children:c("page.albumArtistDetail.viewAll",{postProcess:"sentenceCase"})})]})}),s.jsx(is,{autoFitColumns:!0,autoHeight:!0,columnDefs:O,context:{itemType:u.SONG},deselectOnClickOutside:!0,enableCellChangeFlash:!1,getRowId:e=>e.data.uniqueId,onCellContextMenu:Pt,onRowDoubleClicked:Ft,rowData:Ht,rowHeight:60,rowSelection:"multiple",shouldUpdateSong:!0,stickyHeader:!0,suppressCellFocus:!0,suppressHorizontalScroll:!0,suppressLoadingOverlay:!0,suppressRowDrag:!0})]})}):null,F.filter(e=>!e.isHidden).map(e=>s.jsx(z.Col,{order:e.order,span:12,children:s.jsx(E,{component:"section",children:s.jsx(Et,{spacing:"xl",children:s.jsx(hs,{cardRows:P[e.itemType],data:e.data,isLoading:e.loading,itemType:e.itemType,route:A[e.itemType],swiperProps:{grid:{rows:2}},title:{label:e.title},uniqueId:e.uniqueId})})})},`carousel-${e.uniqueId}`))]})]})]})},Ls=S.forwardRef(({background:D},c)=>{var _,U,o,r,l,O,P;const{albumArtistId:R,artistId:M}=Y(),C=M||R,m=W(),{t:h}=Mt(),a=y({query:{id:C},serverId:m==null?void 0:m.id}),i=(_=a==null?void 0:a.data)==null?void 0:_.albumCount,g=(U=a==null?void 0:a.data)==null?void 0:U.songCount,p=(o=a==null?void 0:a.data)==null?void 0:o.duration,n=p!=null,f=[{enabled:i!=null,id:"albumCount",secondary:!1,value:h("entity.albumWithCount",{count:i||0})},{enabled:g!=null,id:"songCount",secondary:!1,value:h("entity.trackWithCount",{count:g||0})},{enabled:n,id:"duration",secondary:!0,value:n&&os(p)}],d=rs({}),I=A=>{a!=null&&a.data&&d.mutate({query:{item:[a.data],rating:A},serverId:a==null?void 0:a.data.serverId})},t=((r=a==null?void 0:a.data)==null?void 0:r.serverType)===H.NAVIDROME;return s.jsx(ds,{background:D,imageUrl:(l=a==null?void 0:a.data)==null?void 0:l.imageUrl,item:{route:T.LIBRARY_ALBUM_ARTISTS,type:u.ALBUM_ARTIST},ref:c,title:((O=a==null?void 0:a.data)==null?void 0:O.name)||"",children:s.jsx(Et,{children:s.jsxs(L,{children:[f.filter(A=>A.enabled).map((A,F)=>s.jsxs(S.Fragment,{children:[F>0&&s.jsx(G,{$noSelect:!0,children:"•"}),s.jsx(G,{$secondary:A.secondary,children:A.value})]},`item-${A.id}-${F}`)),t&&s.jsxs(s.Fragment,{children:[s.jsx(G,{$noSelect:!0,children:"•"}),s.jsx(ls,{onChange:I,readOnly:(a==null?void 0:a.isFetching)||d.isLoading,value:((P=a==null?void 0:a.data)==null?void 0:P.userRating)||0})]})]})})})}),_s=()=>{var f,d;const D=S.useRef(null),c=S.useRef(null),R=W(),{albumArtistId:M,artistId:C}=Y(),m=C||M,h=wt(),a=vt(),i=y({query:{id:m},serverId:R==null?void 0:R.id}),{color:g,colorId:p}=cs({id:m,src:(f=i.data)==null?void 0:f.imageUrl,srcLoaded:!i.isLoading}),n=()=>{h==null||h({byItemType:{id:[m],type:u.ALBUM_ARTIST},playType:a})};return!g||p!==m?s.jsx(ms,{container:!0}):s.jsx(ps,{children:s.jsxs(us,{pageHeaderProps:{backgroundColor:g,children:s.jsxs($,{children:[s.jsx($.PlayButton,{onClick:n}),s.jsx($.Title,{children:(d=i==null?void 0:i.data)==null?void 0:d.name})]}),offset:200,target:c},ref:D,children:[s.jsx(Ls,{background:g,ref:c}),s.jsx(Ts,{background:g})]})},`album-artist-detail-${m}`)};export{_s as default};
//# sourceMappingURL=album-artist-detail-route-GFnmypiq.js.map
