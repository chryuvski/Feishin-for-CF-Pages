const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./genre-list-grid-view-z6p32cB3.js","./index-qz_z9GmZ.js","./index.css","./genre-list-table-view-B-cJD1re.js","./use-virtual-table-BjhVw3T4.js"])))=>i.map(i=>d[i]);
import{u as J,d as _,j as e,r as c,e as h,S as he,_ as Y,i as X,y as xe,z as N,l as je,B as Z,bl as ge,bR as Ce,C as ye,n as A,E as fe,G as B,H as M,m as b,q as Te,cf as F,J as ee,t as P,K as n,M as k,D as R,O as be,I as ve,R as Le,U as Q,W as Se,cg as ke,ch as Ae,a0 as Ee,a1 as W,s as te,a2 as Fe,ci as Re,T as Ge,v as we,a6 as Ie,o as Pe,P as Oe,L as z,a8 as Be,a9 as Me,A as ze,ae as De}from"./index-qz_z9GmZ.js";import{u as _e}from"./genre-list-query-DUF8G_30.js";const Ne=c.lazy(()=>Y(()=>import("./genre-list-grid-view-z6p32cB3.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(o=>({default:o.GenreListGridView}))),Ve=c.lazy(()=>Y(()=>import("./genre-list-table-view-B-cJD1re.js"),__vite__mapDeps([3,1,2,4]),import.meta.url).then(o=>({default:o.GenreListTableView}))),He=({gridRef:o,itemCount:u,tableRef:d})=>{const{pageKey:r}=J(),{display:x}=_({key:r});return e.jsx(c.Suspense,{fallback:e.jsx(he,{container:!0}),children:x===h.CARD||x===h.POSTER?e.jsx(Ne,{gridRef:o,itemCount:u}):e.jsx(Ve,{itemCount:u,tableRef:d})})},D={jellyfin:[{defaultOrder:b.ASC,name:M.t("filter.name",{postProcess:"titleCase"}),value:B.NAME}],navidrome:[{defaultOrder:b.ASC,name:M.t("filter.name",{postProcess:"titleCase"}),value:B.NAME}],subsonic:[{defaultOrder:b.ASC,name:M.t("filter.name",{postProcess:"titleCase"}),value:B.NAME}]},Ke=({gridRef:o,itemCount:u,tableRef:d})=>{var $,q;const{t:r}=X(),x=xe(),{customFilters:l,pageKey:a}=J(),s=N(),{setDisplayType:g,setFilter:m,setGrid:G,setTable:C}=je(),{display:y,filter:p,grid:v,table:L}=_({key:a}),se=Z(),{genreTarget:w}=ge(),{setGenreBehavior:V}=Ce(),{handleRefreshGrid:H,handleRefreshTable:K}=ye({itemCount:u,itemType:A.GENRE,server:s}),ne=fe({serverId:s==null?void 0:s.id}),ae=(s==null?void 0:s.type)&&(($=D[s.type].find(t=>t.value===p.sortBy))==null?void 0:$.name)||"Unknown",f=y===h.CARD||y===h.POSTER,j=c.useCallback(t=>{f?H(o,{...t,...l}):K(d,{...t,...l})},[l,o,H,K,f,d]),U=c.useCallback(()=>{x.invalidateQueries(Te.genres.list((s==null?void 0:s.id)||"")),j(p)},[p,j,x,s==null?void 0:s.id]),re=c.useCallback(t=>{var S,I;if(!((S=t.currentTarget)!=null&&S.value)||!(s!=null&&s.type))return;const i=(I=D[s.type].find(E=>E.value===t.currentTarget.value))==null?void 0:I.defaultOrder,T=m({customFilters:l,data:{sortBy:t.currentTarget.value,sortOrder:i||b.ASC},itemType:A.GENRE,key:a});j(T)},[l,j,a,s==null?void 0:s.type,m]),ie=c.useCallback(t=>{var T;if(!((T=t.currentTarget)!=null&&T.value))return;let i=null;t.currentTarget.value===String(p.musicFolderId)?i=m({customFilters:l,data:{musicFolderId:void 0},itemType:A.GENRE,key:a}):i=m({customFilters:l,data:{musicFolderId:t.currentTarget.value},itemType:A.GENRE,key:a}),j(i)},[p.musicFolderId,j,m,l,a]),le=c.useCallback(()=>{const t=p.sortOrder===b.ASC?b.DESC:b.ASC,i=m({customFilters:l,data:{sortOrder:t},itemType:A.GENRE,key:a});j(i)},[l,p.sortOrder,j,a,m]),oe=t=>{f?G({data:{itemSize:t},key:a}):C({data:{rowHeight:t},key:a})},ce=t=>{G({data:{itemGap:t},key:a})},O=c.useCallback(t=>{var i;(i=t.currentTarget)!=null&&i.value&&g({data:t.currentTarget.value,key:a})},[a,g]),de=t=>{var T;const i=L.columns;if(t.length===0)return C({data:{columns:[]},key:a});if(t.length>i.length){const S={column:t[t.length-1],width:100};C({data:{columns:[...i,S]},key:a})}else{const S=i.filter(E=>!t.includes(E.column)),I=i.filter(E=>!S.includes(E));C({data:{columns:I},key:a})}return(T=d.current)==null?void 0:T.api.sizeColumnsToFit()},ue=t=>{var i;C({data:{autoFit:t.currentTarget.checked},key:a}),t.currentTarget.checked&&((i=d.current)==null||i.api.sizeColumnsToFit())},me=c.useMemo(()=>p.musicFolderId!==void 0,[p.musicFolderId]),pe=c.useCallback(()=>{const t=w===F.ALBUM?F.TRACK:F.ALBUM;V(t)},[w,V]);return e.jsxs(ee,{justify:"space-between",children:[e.jsxs(P,{ref:se.ref,spacing:"sm",w:"100%",children:[e.jsxs(n,{position:"bottom-start",children:[e.jsx(n.Target,{children:e.jsx(k,{compact:!0,fw:600,size:"md",variant:"subtle",children:ae})}),e.jsx(n.Dropdown,{children:D[s==null?void 0:s.type].map(t=>e.jsx(n.Item,{$isActive:t.value===p.sortBy,onClick:re,value:t.value,children:t.name},`filter-${t.name}`))})]}),e.jsx(R,{orientation:"vertical"}),e.jsx(be,{onToggle:le,sortOrder:p.sortOrder}),(s==null?void 0:s.type)===ve.JELLYFIN&&e.jsxs(e.Fragment,{children:[e.jsx(R,{orientation:"vertical"}),e.jsxs(n,{position:"bottom-start",children:[e.jsx(n.Target,{children:e.jsx(k,{compact:!0,fw:600,size:"md",sx:{svg:{fill:me?"var(--primary-color) !important":void 0}},variant:"subtle",children:e.jsx(Le,{size:"1.3rem"})})}),e.jsx(n.Dropdown,{children:(q=ne.data)==null?void 0:q.items.map(t=>e.jsx(n.Item,{$isActive:p.musicFolderId===t.id,onClick:ie,value:t.id,children:t.name},`musicFolder-${t.id}`))})]})]}),e.jsx(R,{orientation:"vertical"}),e.jsx(k,{compact:!0,onClick:U,size:"md",tooltip:{label:r("common.refresh",{postProcess:"titleCase"})},variant:"subtle",children:e.jsx(Q,{size:"1.3rem"})}),e.jsx(R,{orientation:"vertical"}),e.jsxs(n,{position:"bottom-start",children:[e.jsx(n.Target,{children:e.jsx(k,{compact:!0,size:"md",variant:"subtle",children:e.jsx(Se,{size:15})})}),e.jsx(n.Dropdown,{children:e.jsx(n.Item,{icon:e.jsx(Q,{}),onClick:U,children:r("common.refresh",{postProcess:"titleCase"})})}),e.jsx(R,{orientation:"vertical"}),e.jsx(k,{compact:!0,onClick:pe,size:"md",tooltip:{label:r(w===F.ALBUM?"page.genreList.showAlbums":"page.genreList.showTracks",{postProcess:"sentenceCase"})},variant:"subtle",children:w===F.ALBUM?e.jsx(ke,{}):e.jsx(Ae,{})})]})]}),e.jsx(P,{noWrap:!0,spacing:"sm",children:e.jsxs(n,{position:"bottom-end",width:425,children:[e.jsx(n.Target,{children:e.jsx(k,{compact:!0,size:"md",tooltip:{label:r("common.configure",{postProcess:"titleCase"})},variant:"subtle",children:e.jsx(Ee,{size:"1.3rem"})})}),e.jsxs(n.Dropdown,{children:[e.jsx(n.Label,{children:r("table.config.general.displayType",{postProcess:"sentenceCase"})}),e.jsx(n.Item,{$isActive:y===h.CARD,onClick:O,value:h.CARD,children:r("table.config.view.card",{postProcess:"titleCase"})}),e.jsx(n.Item,{$isActive:y===h.POSTER,onClick:O,value:h.POSTER,children:r("table.config.view.poster",{postProcess:"titleCase"})}),e.jsx(n.Item,{$isActive:y===h.TABLE,onClick:O,value:h.TABLE,children:r("table.config.view.table",{postProcess:"titleCase"})}),e.jsx(n.Divider,{}),e.jsx(n.Label,{children:r("table.config.general.size",{postProcess:"titleCase"})}),e.jsx(n.Item,{closeMenuOnClick:!1,children:e.jsx(W,{defaultValue:f?(v==null?void 0:v.itemSize)||0:L.rowHeight,max:f?300:100,min:f?100:25,onChangeEnd:oe})}),f&&e.jsxs(e.Fragment,{children:[e.jsx(n.Label,{children:r("table.config.general.itemGap",{postProcess:"sentenceCase"})}),e.jsx(n.Item,{closeMenuOnClick:!1,children:e.jsx(W,{defaultValue:(v==null?void 0:v.itemGap)||0,max:30,min:0,onChangeEnd:ce})})]}),(y===h.TABLE||y===h.TABLE_PAGINATED)&&e.jsxs(e.Fragment,{children:[e.jsx(n.Label,{children:r("table.config.general.tableColumns",{postProcess:"titleCase"})}),e.jsx(n.Item,{closeMenuOnClick:!1,component:"div",sx:{cursor:"default"},children:e.jsxs(te,{children:[e.jsx(Fe,{clearable:!0,data:Re,defaultValue:L==null?void 0:L.columns.map(t=>t.column),onChange:de,width:300}),e.jsxs(P,{position:"apart",children:[e.jsx(Ge,{children:r("table.config.general.autoFitColumns",{postProcess:"titleCase"})}),e.jsx(we,{defaultChecked:L.autoFit,onChange:ue})]})]})})]})]})]})})]})},Ue=({gridRef:o,itemCount:u,tableRef:d})=>{const{t:r}=X(),x=Z(),l=N(),{filter:a,refresh:s,search:g}=Ie({gridRef:o,itemType:A.GENRE,server:l,tableRef:d}),m=Pe(G=>{const C=g(G);s(C)},500);return e.jsxs(te,{ref:x.ref,spacing:0,children:[e.jsx(Oe,{backgroundColor:"var(--titlebar-bg)",children:e.jsxs(ee,{justify:"space-between",w:"100%",children:[e.jsxs(z,{children:[e.jsx(z.Title,{children:r("page.genreList.title",{postProcess:"titleCase"})}),e.jsx(z.Badge,{isLoading:u==null,children:u})]}),e.jsx(P,{children:e.jsx(Be,{defaultValue:a.searchTerm,onChange:m,openedWidth:x.isMd?250:x.isSm?200:150})})]})}),e.jsx(Me,{children:e.jsx(Ke,{gridRef:o,itemCount:u,tableRef:d})})]})},Qe=()=>{var g,m;const o=c.useRef(null),u=c.useRef(null),d=N(),r="genre",{filter:x}=_({key:r}),l=_e({query:{...x,limit:1,startIndex:0},serverId:d==null?void 0:d.id}),a=((g=l.data)==null?void 0:g.totalRecordCount)===null||(m=l.data)==null?void 0:m.totalRecordCount,s=c.useMemo(()=>({pageKey:r}),[]);return e.jsx(ze,{children:e.jsxs(De.Provider,{value:s,children:[e.jsx(Ue,{gridRef:o,itemCount:a,tableRef:u}),e.jsx(He,{gridRef:o,itemCount:a,tableRef:u})]})})};export{Qe as default};
//# sourceMappingURL=genre-list-route-CeWXKq7B.js.map
