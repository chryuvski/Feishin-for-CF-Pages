import{y as E,z as O,ac as G,u as N,d as _,l as q,r as y,q as R,h as w,ct as s,cu as i,j as h,aH as B,cv as U,cw as z,aU as P,n as j,e as F}from"./index-qz_z9GmZ.js";import{u as K}from"./use-handle-favorite-DgTaOWZK.js";const g=({gridRef:m,itemCount:d})=>{const u=E(),e=O(),T=G(),{pageKey:p}=N(),{display:k,filter:r,grid:a}=_({key:p}),{setGrid:S}=q(),b=K({gridRef:m,server:e}),I=y.useCallback(()=>{const t={...r},o=u.getQueriesData({exact:!1,fetchStatus:"idle",queryKey:R.artists.list((e==null?void 0:e.id)||"",t),stale:!1}),c=[];for(const[,A]of o){const{items:n,startIndex:l}=A||{};if(n&&n.length!==1&&l!==void 0){let C=0;for(let f=l;f<l+n.length;f+=1)c[f]=n[C],C+=1}}return c},[r,u,e==null?void 0:e.id]),L=y.useCallback(async({skip:t,take:o})=>{const c={...r,limit:o,startIndex:t},A=R.artists.list((e==null?void 0:e.id)||"",c);return await u.fetchQuery(A,async({signal:l})=>w.controller.getArtistList({apiClientProps:{server:e,signal:l},query:c}),{cacheTime:1e3*60*1})},[r,u,e]),D=y.useCallback(t=>{S({data:{scrollOffset:t.scrollOffset},key:p})},[p,S]),x=y.useMemo(()=>{const t=[i.name];switch(r.sortBy){case s.ALBUM_COUNT:t.push(i.albumCount);break;case s.DURATION:t.push(i.duration);break;case s.FAVORITED:break;case s.NAME:break;case s.PLAY_COUNT:t.push(i.playCount);break;case s.RANDOM:break;case s.RATING:t.push(i.rating);break;case s.RECENTLY_ADDED:break;case s.RELEASE_DATE:break;case s.SONG_COUNT:t.push(i.songCount);break}return t},[r.sortBy]);return h.jsx(B,{children:h.jsx(U,{children:({height:t,width:o})=>h.jsx(z,{cardRows:x,display:k||F.CARD,fetchFn:L,fetchInitialData:I,handleFavorite:b,handlePlayQueueAdd:T,height:t,initialScrollOffset:(a==null?void 0:a.scrollOffset)||0,itemCount:d||0,itemGap:(a==null?void 0:a.itemGap)??10,itemSize:(a==null?void 0:a.itemSize)||200,itemType:j.ARTIST,loading:d==null,minimumBatchSize:40,onScroll:D,ref:m,route:{route:P.LIBRARY_ARTISTS_DETAIL,slugs:[{idProperty:"id",slugProperty:"artistId"}]},width:o})})})};export{g as ArtistListGridView};
//# sourceMappingURL=artist-list-grid-view-VEKtcgCJ.js.map
