import{y as E,z as O,ac as _,u as B,d as G,l as N,r as A,q as C,h as U,p as s,cu as i,j as b,aH as q,cv as w,cw as M,aU as z,n as P,e as j}from"./index-qz_z9GmZ.js";import{u as F}from"./use-handle-favorite-DgTaOWZK.js";const g=({gridRef:f,itemCount:y})=>{const u=E(),e=O(),R=_(),{pageKey:d}=B(),{display:T,filter:r,grid:a}=G({key:d}),{setGrid:h}=N(),k=F({gridRef:f,server:e}),L=A.useCallback(()=>{const t={...r},o=u.getQueriesData({exact:!1,fetchStatus:"idle",queryKey:C.albumArtists.list((e==null?void 0:e.id)||"",t),stale:!1}),l=[];for(const[,m]of o){const{items:n,startIndex:c}=m||{};if(n&&n.length!==1&&c!==void 0){let S=0;for(let p=c;p<c+n.length;p+=1)l[p]=n[S],S+=1}}return l},[r,u,e==null?void 0:e.id]),I=A.useCallback(async({skip:t,take:o})=>{const l={...r,limit:o,startIndex:t},m=C.albumArtists.list((e==null?void 0:e.id)||"",l);return await u.fetchQuery(m,async({signal:c})=>U.controller.getAlbumArtistList({apiClientProps:{server:e,signal:c},query:l}),{cacheTime:1e3*60*1})},[r,u,e]),D=A.useCallback(t=>{h({data:{scrollOffset:t.scrollOffset},key:d})},[d,h]),x=A.useMemo(()=>{const t=[i.name];switch(r.sortBy){case s.ALBUM_COUNT:t.push(i.albumCount);break;case s.DURATION:t.push(i.duration);break;case s.FAVORITED:break;case s.NAME:break;case s.PLAY_COUNT:t.push(i.playCount);break;case s.RANDOM:break;case s.RATING:t.push(i.rating);break;case s.RECENTLY_ADDED:break;case s.RELEASE_DATE:break;case s.SONG_COUNT:t.push(i.songCount);break}return t},[r.sortBy]);return b.jsx(q,{children:b.jsx(w,{children:({height:t,width:o})=>b.jsx(M,{cardRows:x,display:T||j.CARD,fetchFn:I,fetchInitialData:L,handleFavorite:k,handlePlayQueueAdd:R,height:t,initialScrollOffset:(a==null?void 0:a.scrollOffset)||0,itemCount:y||0,itemGap:(a==null?void 0:a.itemGap)??10,itemSize:(a==null?void 0:a.itemSize)||200,itemType:P.ALBUM_ARTIST,loading:y==null,minimumBatchSize:40,onScroll:D,ref:f,route:{route:z.LIBRARY_ALBUM_ARTISTS_DETAIL,slugs:[{idProperty:"id",slugProperty:"albumArtistId"}]},width:o})})})};export{g as AlbumArtistListGridView};
//# sourceMappingURL=album-artist-list-grid-view-CxWIjNqw.js.map
