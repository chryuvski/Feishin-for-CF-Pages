const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./album-list-grid-view-DfrQaaka.js","./index-qz_z9GmZ.js","./index.css","./use-handle-favorite-DgTaOWZK.js","./album-list-table-view-DwyAVVro.js","./use-virtual-table-BjhVw3T4.js"])))=>i.map(i=>d[i]);
import{u as _e,d as re,j as e,r as b,e as B,S as Ue,_ as Fe,g as Ee,f as ke,q as ne,h as ye,i as ee,k as Oe,l as oe,m as p,G as le,n as v,o as Y,p as Me,s as se,t as M,T as ie,v as ce,D as H,N as te,w as Ie,x as Ve,y as qe,z as xe,B as Be,C as Ge,E as ze,F as y,H as x,I as Q,J as De,K as C,M as K,O as $e,R as He,Q as Je,U as Se,W as We,X as me,Y as Xe,Z as Ze,$ as Qe,a0 as Ke,a1 as Pe,a2 as et,a3 as tt,a4 as st,a5 as at,a6 as rt,P as nt,L as ae,a7 as Re,a8 as ot,a9 as lt,aa as it,ab as ct,ac as dt,ad as ut,A as mt,ae as pt}from"./index-qz_z9GmZ.js";import{u as we,M as pe,S as he,i as ht,s as Le}from"./use-tag-list-CmDBDSdm.js";import{u as de}from"./genre-list-query-DUF8G_30.js";const Ct=b.lazy(()=>Fe(()=>import("./album-list-grid-view-DfrQaaka.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(m=>({default:m.AlbumListGridView}))),yt=b.lazy(()=>Fe(()=>import("./album-list-table-view-DwyAVVro.js"),__vite__mapDeps([4,1,2,5]),import.meta.url).then(m=>({default:m.AlbumListTableView}))),xt=({gridRef:m,itemCount:T,tableRef:d})=>{const{pageKey:r}=_e(),{display:u}=re({key:r});return e.jsx(b.Suspense,{fallback:e.jsx(Ue,{container:!0}),children:u===B.CARD||u===B.POSTER?e.jsx(Ct,{gridRef:m,itemCount:T}):e.jsx(yt,{itemCount:T,tableRef:d})})},Ne=m=>{const{options:T,query:d,serverId:r}=m||{},u=Ee(r);return ke({enabled:!!(u!=null&&u.id),queryFn:({signal:i})=>{if(!u)throw new Error("Server not found");return ye.controller.getAlbumArtistList({apiClientProps:{server:u,signal:i},query:d})},queryKey:ne.albumArtists.list((u==null?void 0:u.id)||"",d),...T})},At=({customFilters:m,disableArtistFilter:T,onFilterChange:d,pageKey:r,serverId:u})=>{var I,L,V,D,R,J,W,X;const{t:i}=ee(),t=Oe({key:r}),{setFilter:c}=oe(),a=de({query:{musicFolderId:t==null?void 0:t.musicFolderId,sortBy:le.NAME,sortOrder:p.ASC,startIndex:0},serverId:u}),_=b.useMemo(()=>a!=null&&a.data?a.data.items.map(l=>({label:l.name,value:l.id})):[],[a.data]),f=we({query:{folder:t==null?void 0:t.musicFolderId,type:v.ALBUM},serverId:u}),F=b.useMemo(()=>{var l,n,h;return(h=(n=(l=t==null?void 0:t._custom)==null?void 0:l.jellyfin)==null?void 0:n.Tags)==null?void 0:h.split("|")},[(L=(I=t==null?void 0:t._custom)==null?void 0:I.jellyfin)==null?void 0:L.Tags]),E=[{label:i("filter.isFavorited",{postProcess:"sentenceCase"}),onChange:l=>{const n=c({customFilters:m,data:{_custom:t==null?void 0:t._custom,favorite:l.currentTarget.checked?!0:void 0},itemType:v.ALBUM,key:r});d(n)},value:t==null?void 0:t.favorite}],P=Y(l=>{if(typeof l=="number"&&(l<1700||l>2300))return;const n=c({customFilters:m,data:{_custom:t==null?void 0:t._custom,minYear:l===""?void 0:l},itemType:v.ALBUM,key:r});d(n)},500),s=Y(l=>{if(typeof l=="number"&&(l<1700||l>2300))return;const n=c({customFilters:m,data:{_custom:t==null?void 0:t._custom,maxYear:l===""?void 0:l},itemType:v.ALBUM,key:r});d(n)},500),g=Y(l=>{const n=c({customFilters:m,data:{_custom:t==null?void 0:t._custom,genres:l},itemType:v.ALBUM,key:r});d(n)},250),[A,w]=b.useState(""),k=Ne({options:{cacheTime:1e3*60*2,staleTime:1e3*60*1},query:{sortBy:Me.NAME,sortOrder:p.ASC,startIndex:0},serverId:u}),O=b.useMemo(()=>{var l,n,h;return(l=k==null?void 0:k.data)!=null&&l.items?(h=(n=k==null?void 0:k.data)==null?void 0:n.items)==null?void 0:h.map(j=>({label:j.name,value:j.id})):[]},[(V=k==null?void 0:k.data)==null?void 0:V.items]),N=l=>{const n=c({customFilters:m,data:{_custom:t==null?void 0:t._custom,artistIds:l||void 0},itemType:v.ALBUM,key:r});d(n)},U=Y(l=>{var h;const n=c({customFilters:m,data:{_custom:{...t==null?void 0:t._custom,jellyfin:{...(h=t==null?void 0:t._custom)==null?void 0:h.jellyfin,Tags:(l==null?void 0:l.join("|"))||void 0}}},itemType:v.SONG,key:r});d(n)},250);return e.jsxs(se,{p:"0.8rem",children:[E.map(l=>e.jsxs(M,{position:"apart",children:[e.jsx(ie,{children:l.label}),e.jsx(ce,{checked:(l==null?void 0:l.value)||!1,onChange:l.onChange,size:"xs"})]},`nd-filter-${l.label}`)),e.jsx(H,{my:"0.5rem"}),e.jsxs(M,{grow:!0,children:[e.jsx(te,{defaultValue:t==null?void 0:t.minYear,hideControls:!1,label:i("filter.fromYear",{postProcess:"sentenceCase"}),max:2300,min:1700,onChange:l=>P(l),required:!!(t!=null&&t.maxYear)}),e.jsx(te,{defaultValue:t==null?void 0:t.maxYear,hideControls:!1,label:i("filter.toYear",{postProcess:"sentenceCase"}),max:2300,min:1700,onChange:l=>s(l),required:!!(t!=null&&t.minYear)})]}),e.jsx(M,{grow:!0,children:e.jsx(pe,{clearable:!0,data:_,defaultValue:t.genres,label:i("entity.genre",{count:2,postProcess:"sentenceCase"}),onChange:g,searchable:!0})}),e.jsx(M,{grow:!0,children:e.jsx(pe,{clearable:!0,data:O,defaultValue:(J=(R=(D=t==null?void 0:t._custom)==null?void 0:D.jellyfin)==null?void 0:R.AlbumArtistIds)==null?void 0:J.split(","),disabled:T,label:i("entity.artist",{count:2,postProcess:"sentenceCase"}),limit:300,onChange:N,onSearchChange:w,placeholder:"Type to search for an artist",rightSection:k.isFetching?e.jsx(Ie,{}):void 0,searchable:!0,searchValue:A})}),((X=(W=f.data)==null?void 0:W.boolTags)==null?void 0:X.length)&&e.jsx(M,{grow:!0,children:e.jsx(pe,{clearable:!0,data:f.data.boolTags,defaultValue:F,label:i("common.tags",{postProcess:"sentenceCase"}),onChange:U,searchable:!0,width:250})})]})},bt=({customFilters:m,disableArtistFilter:T,onFilterChange:d,pageKey:r,serverId:u})=>{var N,U,I,L,V,D,R,J,W,X,l;const{t:i}=ee(),{filter:t}=re({key:r}),{setFilter:c}=oe(),a=de({query:{sortBy:le.NAME,sortOrder:p.ASC,startIndex:0},serverId:u}),_=b.useMemo(()=>a!=null&&a.data?a.data.items.map(n=>({label:n.name,value:n.id})):[],[a.data]),f=Y(n=>{const h=c({customFilters:m,data:{_custom:t._custom,genres:n?[n]:void 0},itemType:v.ALBUM,key:r});d(h)},250),F=we({query:{type:v.ALBUM},serverId:u}),E=[{label:i("filter.isRated",{postProcess:"sentenceCase"}),onChange:n=>{var j;const h=c({customFilters:m,data:{_custom:{...t._custom,navidrome:{...(j=t._custom)==null?void 0:j.navidrome,has_rating:n.currentTarget.checked?!0:void 0}}},itemType:v.ALBUM,key:r});d(h)},value:(U=(N=t._custom)==null?void 0:N.navidrome)==null?void 0:U.has_rating},{label:i("filter.isFavorited",{postProcess:"sentenceCase"}),onChange:n=>{const h=c({customFilters:m,data:{_custom:t._custom,favorite:n.currentTarget.checked?!0:void 0},itemType:v.ALBUM,key:r});d(h)},value:t.favorite},{label:i("filter.isCompilation",{postProcess:"sentenceCase"}),onChange:n=>{const h=c({customFilters:m,data:{_custom:t._custom,compilation:n.currentTarget.checked?!0:void 0},itemType:v.ALBUM,key:r});d(h)},value:t.compilation},{label:i("filter.isRecentlyPlayed",{postProcess:"sentenceCase"}),onChange:n=>{var j;const h=c({customFilters:m,data:{_custom:{...t._custom,navidrome:{...(j=t._custom)==null?void 0:j.navidrome,recently_played:n.currentTarget.checked?!0:void 0}}},itemType:v.ALBUM,key:r});d(h)},value:(L=(I=t._custom)==null?void 0:I.navidrome)==null?void 0:L.recently_played}],P=Y(n=>{var j;const h=c({customFilters:m,data:{_custom:{...t._custom,navidrome:{...(j=t._custom)==null?void 0:j.navidrome,year:n===""?void 0:n}}},itemType:v.ALBUM,key:r});d(h)},500),[s,g]=b.useState(""),A=Ne({options:{cacheTime:1e3*60*2,staleTime:1e3*60*1},query:{sortBy:Me.NAME,sortOrder:p.ASC,startIndex:0},serverId:u}),w=b.useMemo(()=>{var n,h,j;return(n=A==null?void 0:A.data)!=null&&n.items?(j=(h=A==null?void 0:A.data)==null?void 0:h.items)==null?void 0:j.map(q=>({label:q.name,value:q.id})):[]},[(V=A==null?void 0:A.data)==null?void 0:V.items]),k=n=>{var j;const h=c({data:{_custom:{...t._custom,navidrome:{...(j=t._custom)==null?void 0:j.navidrome,artist_id:n||void 0}}},itemType:v.ALBUM,key:r});d(h)},O=Y((n,h)=>{var q;const j=c({customFilters:m,data:{_custom:{...t._custom,navidrome:{...(q=t._custom)==null?void 0:q.navidrome,[n]:h||void 0}}},itemType:v.SONG,key:r});d(j)},250);return e.jsxs(se,{p:"0.8rem",children:[E.map(n=>e.jsxs(M,{position:"apart",children:[e.jsx(ie,{children:n.label}),e.jsx(ce,{checked:(n==null?void 0:n.value)||!1,onChange:n.onChange})]},`nd-filter-${n.label}`)),e.jsx(H,{my:"0.5rem"}),e.jsxs(M,{grow:!0,children:[e.jsx(te,{defaultValue:(R=(D=t._custom)==null?void 0:D.navidrome)==null?void 0:R.year,hideControls:!1,label:i("common.year",{postProcess:"titleCase"}),max:5e3,min:0,onChange:n=>P(n)}),e.jsx(he,{clearable:!0,data:_,defaultValue:t.genres&&t.genres[0],label:i("entity.genre",{count:1,postProcess:"titleCase"}),onChange:f,searchable:!0})]}),e.jsx(M,{grow:!0,children:e.jsx(he,{clearable:!0,data:w,defaultValue:(W=(J=t._custom)==null?void 0:J.navidrome)==null?void 0:W.artist_id,disabled:T,label:i("entity.artist",{count:1,postProcess:"titleCase"}),limit:300,onChange:k,onSearchChange:g,rightSection:A.isFetching?e.jsx(Ie,{}):void 0,searchable:!0,searchValue:s})}),((l=(X=F.data)==null?void 0:X.enumTags)==null?void 0:l.length)&&F.data.enumTags.map(n=>{var h,j;return e.jsx(M,{grow:!0,children:e.jsx(he,{clearable:!0,data:n.options,defaultValue:(j=(h=t._custom)==null?void 0:h.navidrome)==null?void 0:j[n.name],label:n.name,onChange:q=>O(n.name,q),searchable:!0,width:150})},n.name)})]})},vt=({onFilterChange:m,pageKey:T,serverId:d})=>{var F,E,P;const{t:r}=ee(),{filter:u}=re({key:T}),{setFilter:i}=oe(),t=de({query:{sortBy:le.NAME,sortOrder:p.ASC,startIndex:0},serverId:d}),c=b.useMemo(()=>t!=null&&t.data?t.data.items.map(s=>({label:s.name,value:s.id})):[],[t.data]),a=Y(s=>{const g=i({data:{genres:s?[s]:void 0},itemType:v.ALBUM,key:T});m(g)},250),_=[{label:r("filter.isFavorited",{postProcess:"sentenceCase"}),onChange:s=>{const g=i({data:{favorite:s.target.checked?!0:void 0},itemType:v.ALBUM,key:T});m(g)},value:u.favorite}],f=Y((s,g)=>{let A={};g==="min"?A={minYear:s?Number(s):void 0}:A={maxYear:s?Number(s):void 0};const w=i({data:A,itemType:v.ALBUM,key:T});m(w)},500);return e.jsxs(se,{p:"0.8rem",children:[_.map(s=>e.jsxs(M,{position:"apart",children:[e.jsx(ie,{children:s.label}),e.jsx(ce,{checked:(s==null?void 0:s.value)||!1,onChange:s.onChange})]},`nd-filter-${s.label}`)),e.jsx(H,{my:"0.5rem"}),e.jsxs(M,{grow:!0,children:[e.jsx(te,{defaultValue:u.minYear,disabled:((F=u.genres)==null?void 0:F.length)!==void 0,hideControls:!1,label:r("filter.fromYear",{postProcess:"sentenceCase"}),max:5e3,min:0,onChange:s=>f(s,"min")}),e.jsx(te,{defaultValue:u.maxYear,disabled:((E=u.genres)==null?void 0:E.length)!==void 0,hideControls:!1,label:r("filter.toYear",{postProcess:"sentenceCase"}),max:5e3,min:0,onChange:s=>f(s,"max")})]}),e.jsx(M,{grow:!0,children:e.jsx(Ve,{clearable:!0,data:c,defaultValue:(P=u.genres)!=null&&P.length?u.genres[0]:void 0,disabled:!!(u.minYear||u.maxYear),label:r("entity.genre",{count:1,postProcess:"titleCase"}),onChange:a,searchable:!0})})]})},Ce={jellyfin:[{defaultOrder:p.ASC,name:x.t("filter.albumArtist",{postProcess:"titleCase"}),value:y.ALBUM_ARTIST},{defaultOrder:p.DESC,name:x.t("filter.communityRating",{postProcess:"titleCase"}),value:y.COMMUNITY_RATING},{defaultOrder:p.DESC,name:x.t("filter.criticRating",{postProcess:"titleCase"}),value:y.CRITIC_RATING},{defaultOrder:p.ASC,name:x.t("filter.name",{postProcess:"titleCase"}),value:y.NAME},{defaultOrder:p.DESC,name:x.t("filter.playCount",{postProcess:"titleCase"}),value:y.PLAY_COUNT},{defaultOrder:p.ASC,name:x.t("filter.random",{postProcess:"titleCase"}),value:y.RANDOM},{defaultOrder:p.DESC,name:x.t("filter.recentlyAdded",{postProcess:"titleCase"}),value:y.RECENTLY_ADDED},{defaultOrder:p.DESC,name:x.t("filter.releaseDate",{postProcess:"titleCase"}),value:y.RELEASE_DATE}],navidrome:[{defaultOrder:p.ASC,name:x.t("filter.albumArtist",{postProcess:"titleCase"}),value:y.ALBUM_ARTIST},{defaultOrder:p.ASC,name:x.t("filter.artist",{postProcess:"titleCase"}),value:y.ARTIST},{defaultOrder:p.DESC,name:x.t("filter.duration",{postProcess:"titleCase"}),value:y.DURATION},{defaultOrder:p.DESC,name:x.t("filter.mostPlayed",{postProcess:"titleCase"}),value:y.PLAY_COUNT},{defaultOrder:p.ASC,name:x.t("filter.name",{postProcess:"titleCase"}),value:y.NAME},{defaultOrder:p.ASC,name:x.t("filter.random",{postProcess:"titleCase"}),value:y.RANDOM},{defaultOrder:p.DESC,name:x.t("filter.rating",{postProcess:"titleCase"}),value:y.RATING},{defaultOrder:p.DESC,name:x.t("filter.recentlyAdded",{postProcess:"titleCase"}),value:y.RECENTLY_ADDED},{defaultOrder:p.DESC,name:x.t("filter.recentlyPlayed",{postProcess:"titleCase"}),value:y.RECENTLY_PLAYED},{defaultOrder:p.DESC,name:x.t("filter.songCount",{postProcess:"titleCase"}),value:y.SONG_COUNT},{defaultOrder:p.DESC,name:x.t("filter.favorited",{postProcess:"titleCase"}),value:y.FAVORITED},{defaultOrder:p.DESC,name:x.t("filter.releaseYear",{postProcess:"titleCase"}),value:y.YEAR}],subsonic:[{defaultOrder:p.ASC,name:x.t("filter.albumArtist",{postProcess:"titleCase"}),value:y.ALBUM_ARTIST},{defaultOrder:p.DESC,name:x.t("filter.mostPlayed",{postProcess:"titleCase"}),value:y.PLAY_COUNT},{defaultOrder:p.ASC,name:x.t("filter.name",{postProcess:"titleCase"}),value:y.NAME},{defaultOrder:p.ASC,name:x.t("filter.random",{postProcess:"titleCase"}),value:y.RANDOM},{defaultOrder:p.DESC,name:x.t("filter.recentlyAdded",{postProcess:"titleCase"}),value:y.RECENTLY_ADDED},{defaultOrder:p.DESC,name:x.t("filter.recentlyPlayed",{postProcess:"titleCase"}),value:y.RECENTLY_PLAYED},{defaultOrder:p.DESC,name:x.t("filter.favorited",{postProcess:"titleCase"}),value:y.FAVORITED},{defaultOrder:p.DESC,name:x.t("filter.releaseYear",{postProcess:"titleCase"}),value:y.YEAR}]},jt=({gridRef:m,itemCount:T,tableRef:d})=>{var Ae,be,ve,je,Te;const{t:r}=ee(),u=qe(),{customFilters:i,handlePlay:t,pageKey:c}=_e(),a=xe(),{setDisplayType:_,setFilter:f,setGrid:F,setTable:E}=oe(),{display:P,filter:s,grid:g,table:A}=re({filter:i,key:c}),w=Be(),{handleRefreshGrid:k,handleRefreshTable:O}=Ge({itemCount:T,itemType:v.ALBUM,server:a}),N=ze({serverId:a==null?void 0:a.id}),U=(a==null?void 0:a.type)&&((Ae=Ce[a.type].find(o=>o.value===s.sortBy))==null?void 0:Ae.name)||"Unknown",I=P===B.CARD||P===B.POSTER,L=b.useCallback(o=>{I?k(m,{...o,...i}):O(d,{...o,...i})},[i,m,k,O,I,d]),V=()=>{let o;switch(a==null?void 0:a.type){case Q.JELLYFIN:o=At;break;case Q.NAVIDROME:o=bt;break;case Q.SUBSONIC:o=vt;break}o&&st({children:e.jsx(o,{customFilters:i,disableArtistFilter:!!i,onFilterChange:L,pageKey:c,serverId:a==null?void 0:a.id}),title:"Album Filters"})},D=b.useCallback(()=>{u.invalidateQueries(ne.albums.list((a==null?void 0:a.id)||"")),L(s)},[s,L,u,a==null?void 0:a.id]),R=b.useCallback(o=>{var z,Z;if(!((z=o.currentTarget)!=null&&z.value)||!(a!=null&&a.type))return;const S=(Z=Ce[a.type].find($=>$.value===o.currentTarget.value))==null?void 0:Z.defaultOrder,G=f({customFilters:i,data:{sortBy:o.currentTarget.value,sortOrder:S||p.ASC},itemType:v.ALBUM,key:c});L(G)},[i,L,c,a==null?void 0:a.type,f]),J=b.useCallback(o=>{var G;if(!((G=o.currentTarget)!=null&&G.value))return;let S=null;o.currentTarget.value===String(s.musicFolderId)?S=f({customFilters:i,data:{musicFolderId:void 0},itemType:v.ALBUM,key:c}):S=f({customFilters:i,data:{musicFolderId:o.currentTarget.value},itemType:v.ALBUM,key:c}),L(S)},[s.musicFolderId,L,f,i,c]),W=b.useCallback(()=>{const o=s.sortOrder===p.ASC?p.DESC:p.ASC,S=f({customFilters:i,data:{sortOrder:o},itemType:v.ALBUM,key:c});L(S)},[i,s.sortOrder,L,c,f]),X=o=>{I?F({data:{itemSize:o},key:c}):E({data:{rowHeight:o},key:c})},l=o=>{F({data:{itemGap:o},key:c})},n=b.useCallback(o=>{var S;(S=o.currentTarget)!=null&&S.value&&_({data:o.currentTarget.value,key:c})},[c,_]),h=o=>{var G;const S=A.columns;if(o.length===0)return E({data:{columns:[]},key:c});if(o.length>S.length){const z={column:o[o.length-1],width:100};E({data:{columns:[...S,z]},key:c})}else{const z=S.filter($=>!o.includes($.column)),Z=S.filter($=>!z.includes($));E({data:{columns:Z},key:c})}return(G=d.current)==null?void 0:G.api.sizeColumnsToFit()},j=o=>{var S;E({data:{autoFit:o.currentTarget.checked},key:c}),o.currentTarget.checked&&((S=d.current)==null||S.api.sizeColumnsToFit())},q=b.useMemo(()=>{var z,Z,$,fe,ge;const o=(a==null?void 0:a.type)===Q.NAVIDROME&&((z=s==null?void 0:s._custom)==null?void 0:z.navidrome)&&Object.values((Z=s==null?void 0:s._custom)==null?void 0:Z.navidrome).some(ue=>ue!==void 0),S=(a==null?void 0:a.type)===Q.JELLYFIN&&(($=s==null?void 0:s._custom)==null?void 0:$.jellyfin)&&Object.values((fe=s==null?void 0:s._custom)==null?void 0:fe.jellyfin).some(ue=>ue!==void 0),G=(a==null?void 0:a.type)===Q.SUBSONIC&&(s.maxYear||s.minYear||s.favorite);return o||S||G||((ge=s.genres)==null?void 0:ge.length)},[(be=s==null?void 0:s._custom)==null?void 0:be.jellyfin,(ve=s==null?void 0:s._custom)==null?void 0:ve.navidrome,s.favorite,(je=s.genres)==null?void 0:je.length,s.maxYear,s.minYear,a==null?void 0:a.type]),Ye=b.useMemo(()=>s.musicFolderId!==void 0,[s.musicFolderId]);return e.jsxs(De,{justify:"space-between",children:[e.jsxs(M,{ref:w.ref,spacing:"sm",w:"100%",children:[e.jsxs(C,{position:"bottom-start",children:[e.jsx(C.Target,{children:e.jsx(K,{compact:!0,fw:600,size:"md",variant:"subtle",children:U})}),e.jsx(C.Dropdown,{children:Ce[a==null?void 0:a.type].map(o=>e.jsx(C.Item,{$isActive:o.value===s.sortBy,onClick:R,value:o.value,children:o.name},`filter-${o.name}`))})]}),e.jsx(H,{orientation:"vertical"}),e.jsx($e,{onToggle:W,sortOrder:s.sortOrder}),(a==null?void 0:a.type)===Q.JELLYFIN&&e.jsxs(e.Fragment,{children:[e.jsx(H,{orientation:"vertical"}),e.jsxs(C,{position:"bottom-start",children:[e.jsx(C.Target,{children:e.jsx(K,{compact:!0,fw:600,size:"md",sx:{svg:{fill:Ye?"var(--primary-color) !important":void 0}},variant:"subtle",children:e.jsx(He,{size:"1.3rem"})})}),e.jsx(C.Dropdown,{children:(Te=N.data)==null?void 0:Te.items.map(o=>e.jsx(C.Item,{$isActive:s.musicFolderId===o.id,onClick:J,value:o.id,children:o.name},`musicFolder-${o.id}`))})]})]}),e.jsx(H,{orientation:"vertical"}),e.jsx(K,{compact:!0,onClick:V,size:"md",sx:{svg:{fill:q?"var(--primary-color) !important":void 0}},tooltip:{label:r("common.filters",{count:2,postProcess:"sentenceCase"})},variant:"subtle",children:e.jsx(Je,{size:"1.3rem"})}),e.jsx(H,{orientation:"vertical"}),e.jsx(K,{compact:!0,onClick:D,size:"md",tooltip:{label:r("common.refresh",{postProcess:"sentenceCase"})},variant:"subtle",children:e.jsx(Se,{size:"1.3rem"})}),e.jsx(H,{orientation:"vertical"}),e.jsxs(C,{position:"bottom-start",children:[e.jsx(C.Target,{children:e.jsx(K,{compact:!0,size:"md",variant:"subtle",children:e.jsx(We,{size:15})})}),e.jsxs(C.Dropdown,{children:[e.jsx(C.Item,{icon:e.jsx(Xe,{}),onClick:()=>t==null?void 0:t({playType:me.NOW}),children:r("player.play",{postProcess:"sentenceCase"})}),e.jsx(C.Item,{icon:e.jsx(Ze,{}),onClick:()=>t==null?void 0:t({playType:me.LAST}),children:r("player.addLast",{postProcess:"sentenceCase"})}),e.jsx(C.Item,{icon:e.jsx(Qe,{}),onClick:()=>t==null?void 0:t({playType:me.NEXT}),children:r("player.addNext",{postProcess:"sentenceCase"})}),e.jsx(C.Divider,{}),e.jsx(C.Item,{icon:e.jsx(Se,{}),onClick:D,children:r("common.refresh",{postProcess:"sentenceCase"})})]})]})]}),e.jsx(M,{noWrap:!0,spacing:"sm",children:e.jsxs(C,{position:"bottom-end",width:425,children:[e.jsx(C.Target,{children:e.jsx(K,{compact:!0,size:"md",tooltip:{label:r("common.configure",{postProcess:"sentenceCase"})},variant:"subtle",children:e.jsx(Ke,{size:"1.3rem"})})}),e.jsxs(C.Dropdown,{children:[e.jsx(C.Label,{children:r("table.config.general.displayType",{postProcess:"sentenceCase"})}),e.jsx(C.Item,{$isActive:P===B.CARD,onClick:n,value:B.CARD,children:r("table.config.view.card",{postProcess:"sentenceCase"})}),e.jsx(C.Item,{$isActive:P===B.POSTER,onClick:n,value:B.POSTER,children:r("table.config.view.poster",{postProcess:"sentenceCase"})}),e.jsx(C.Item,{$isActive:P===B.TABLE,onClick:n,value:B.TABLE,children:r("table.config.view.table",{postProcess:"sentenceCase"})}),e.jsx(C.Divider,{}),e.jsx(C.Label,{children:r("table.config.general.itemSize",{postProcess:"sentenceCase"})}),e.jsx(C.Item,{closeMenuOnClick:!1,children:e.jsx(Pe,{defaultValue:I?(g==null?void 0:g.itemSize)||0:A.rowHeight,max:I?300:100,min:I?100:25,onChangeEnd:X})}),I&&e.jsxs(e.Fragment,{children:[e.jsx(C.Label,{children:r("table.config.general.itemGap",{postProcess:"sentenceCase"})}),e.jsx(C.Item,{closeMenuOnClick:!1,children:e.jsx(Pe,{defaultValue:(g==null?void 0:g.itemGap)||0,max:30,min:0,onChangeEnd:l})})]}),(P===B.TABLE||P===B.TABLE_PAGINATED)&&e.jsxs(e.Fragment,{children:[e.jsx(C.Label,{children:"Table Columns"}),e.jsx(C.Item,{closeMenuOnClick:!1,component:"div",sx:{cursor:"default"},children:e.jsxs(se,{children:[e.jsx(et,{clearable:!0,data:tt,defaultValue:A==null?void 0:A.columns.map(o=>o.column),onChange:h,width:300}),e.jsxs(M,{position:"apart",children:[e.jsx(ie,{children:"Auto Fit Columns"}),e.jsx(ce,{defaultChecked:A.autoFit,onChange:j})]})]})})]})]})]})})]})},Tt=({genreId:m,gridRef:T,itemCount:d,tableRef:r,title:u})=>{const{t:i}=ee(),t=xe(),c=Be(),a=at(),_=b.useRef(void 0),{filter:f,handlePlay:F,refresh:E,search:P}=rt({gridRef:T,itemCount:d,itemType:v.ALBUM,server:t,tableRef:r}),s=Y(g=>{const A=P(g);E(A)},500);return b.useEffect(()=>{_.current&&_.current!==m&&E(f),_.current=m},[f,m,E,r]),e.jsxs(se,{ref:c.ref,spacing:0,children:[e.jsx(nt,{backgroundColor:"var(--titlebar-bg)",children:e.jsxs(De,{justify:"space-between",w:"100%",children:[e.jsxs(ae,{children:[e.jsx(ae.PlayButton,{onClick:()=>F==null?void 0:F({playType:a})}),e.jsx(ae.Title,{children:u||Re(i("page.albumList.title",{postProcess:"titleCase"}))}),e.jsx(ae.Badge,{isLoading:d==null,children:d})]}),e.jsx(M,{children:e.jsx(ot,{defaultValue:f.searchTerm,onChange:s,openedWidth:c.isMd?250:c.isSm?200:150})})]})}),e.jsx(lt,{children:e.jsx(jt,{gridRef:T,itemCount:d,tableRef:r})})]})},ft=m=>{const{options:T,query:d,serverId:r}=m,u=Ee(r);return ke({enabled:!!r,queryFn:({signal:i})=>{if(!u)throw new Error("Server not found");return ye.controller.getAlbumListCount({apiClientProps:{server:u,signal:i},query:d})},queryKey:ne.albums.count(r||"",Object.keys(d).length===0?void 0:d),...T})},Lt=()=>{const{t:m}=ee(),T=b.useRef(null),d=b.useRef(null),r=xe(),[u]=it(),{albumArtistId:i,genreId:t}=ct(),c=i?"albumArtistAlbum":"album",a=dt(),_=b.useMemo(()=>{const O={...i&&{artistIds:[i]},...t&&{genres:[t]}};if(!ht(O))return O},[i,t]),f=Oe({filter:_,key:c}),F=de({options:{cacheTime:1e3*60*60,enabled:!!t},query:{sortBy:le.NAME,sortOrder:p.ASC,startIndex:0},serverId:r==null?void 0:r.id}),E=b.useMemo(()=>{if(!F.data)return"";const O=F.data.items.find(N=>N.id===t);return O?O==null?void 0:O.name:"Unknown"},[t,F.data]),P=ft({options:{cacheTime:1e3*60,staleTime:1e3*60},query:{...f},serverId:r==null?void 0:r.id}),s=P.data===null?void 0:P.data,g=b.useCallback(async O=>{var D;if(!s||s===0)return;const{playType:N}=O,U={...f,..._,startIndex:0},I=ne.albums.list((r==null?void 0:r.id)||"",U),L=await ut.fetchQuery({queryFn:({signal:R})=>ye.controller.getAlbumList({apiClientProps:{server:r,signal:R},query:U}),queryKey:I}),V=((D=L==null?void 0:L.items)==null?void 0:D.map(R=>R.id))||[];a==null||a({byItemType:{id:V,type:v.ALBUM},playType:N})},[f,_,a,s,r]),A=b.useMemo(()=>({customFilters:_,handlePlay:g,id:i??t,pageKey:c}),[i,_,t,g,c]),w=u.get("artistName"),k=w?Le(m("page.albumList.artistAlbums",{artist:w})):t?Le(m("page.albumList.genreAlbums",{genre:Re(E)})):void 0;return e.jsx(mt,{children:e.jsxs(pt.Provider,{value:A,children:[e.jsx(Tt,{genreId:t,gridRef:T,itemCount:s,tableRef:d,title:k}),e.jsx(xt,{gridRef:T,itemCount:s,tableRef:d})]})})};export{Lt as default};
//# sourceMappingURL=album-list-route-sbRukrrc.js.map
