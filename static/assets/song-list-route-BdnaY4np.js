const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./song-list-table-view-BJrkikN_.js","./index-qz_z9GmZ.js","./index.css","./use-current-song-row-styles-AW__6X7H.js","./use-virtual-table-BjhVw3T4.js","./song-list-grid-view-CeTQTyB6.js","./use-handle-favorite-DgTaOWZK.js"])))=>i.map(i=>d[i]);
import{u as ge,d as Se,e as G,j as e,r as T,S as Ne,_ as ve,i as q,l as X,k as Z,m,G as K,n as f,o as R,s as $,t as N,T as ee,v as te,D as Y,N as ne,x as we,z as re,C as De,B as Te,E as Ge,af as C,H as x,I as z,J as fe,K as y,M as V,O as Me,R as Be,Q as Re,U as ye,W as Ye,X as J,Y as ze,ag as Ve,Z as qe,$ as Ue,a0 as $e,a1 as he,a2 as He,ah as We,a4 as Je,ad as Qe,q as Ae,a6 as Xe,a5 as Ze,P as Ke,L as Q,a8 as et,a9 as tt,g as st,f as at,h as nt,aa as rt,ab as ot,ac as it,a7 as lt,A as ct,ae as dt}from"./index-qz_z9GmZ.js";import{u as be,M as Ce,S as xe,i as ut,s as je}from"./use-tag-list-CmDBDSdm.js";import{u as se}from"./genre-list-query-DUF8G_30.js";const mt=T.lazy(()=>ve(()=>import("./song-list-table-view-BJrkikN_.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(r=>({default:r.SongListTableView}))),pt=T.lazy(()=>ve(()=>import("./song-list-grid-view-CeTQTyB6.js"),__vite__mapDeps([5,1,2,6]),import.meta.url).then(r=>({default:r.SongListGridView}))),yt=({gridRef:r,itemCount:j,tableRef:o})=>{const{pageKey:l}=ge(),{display:s}=Se({key:l}),c=s===G.CARD||s===G.POSTER;return e.jsx(T.Suspense,{fallback:e.jsx(Ne,{container:!0}),children:c?e.jsx(pt,{gridRef:r,itemCount:j}):e.jsx(mt,{itemCount:j,tableRef:o})})},ht=({customFilters:r,onFilterChange:j,pageKey:o,serverId:l})=>{var k,i,O,_,g,H;const{t:s}=q(),{setFilter:c}=X(),t=Z({key:o}),u=(r==null?void 0:r.genreIds)!==void 0,p=se({query:{musicFolderId:t==null?void 0:t.musicFolderId,sortBy:K.NAME,sortOrder:m.ASC,startIndex:0},serverId:l}),a=T.useMemo(()=>p!=null&&p.data?p.data.items.map(d=>({label:d.name,value:d.id})):[],[p.data]),I=be({query:{folder:t==null?void 0:t.musicFolderId,type:f.SONG},serverId:l}),A=T.useMemo(()=>{var d,L,S;return(S=(L=(d=t==null?void 0:t._custom)==null?void 0:d.jellyfin)==null?void 0:L.GenreIds)==null?void 0:S.split(",")},[(i=(k=t==null?void 0:t._custom)==null?void 0:k.jellyfin)==null?void 0:i.GenreIds]),h=T.useMemo(()=>{var d,L,S;return(S=(L=(d=t==null?void 0:t._custom)==null?void 0:d.jellyfin)==null?void 0:L.Tags)==null?void 0:S.split("|")},[(_=(O=t==null?void 0:t._custom)==null?void 0:O.jellyfin)==null?void 0:_.Tags]),b=[{label:s("filter.isFavorited",{postProcess:"sentenceCase"}),onChange:d=>{var S;const L=c({customFilters:r,data:{_custom:{...t==null?void 0:t._custom,jellyfin:{...(S=t==null?void 0:t._custom)==null?void 0:S.jellyfin,IncludeItemTypes:"Audio"}},favorite:d.currentTarget.checked?!0:void 0},itemType:f.SONG,key:o});j(L)},value:t.favorite}],E=R(d=>{var S;if(typeof d=="number"&&(d<1700||d>2300))return;const L=c({customFilters:r,data:{_custom:{...t==null?void 0:t._custom,jellyfin:{...(S=t==null?void 0:t._custom)==null?void 0:S.jellyfin,IncludeItemTypes:"Audio"}},minYear:d===""?void 0:d},itemType:f.SONG,key:o});j(L)},500),F=R(d=>{var S;if(typeof d=="number"&&(d<1700||d>2300))return;const L=c({customFilters:r,data:{_custom:{...t==null?void 0:t._custom,jellyfin:{...(S=t==null?void 0:t._custom)==null?void 0:S.jellyfin,IncludeItemTypes:"Audio"}},maxYear:d===""?void 0:d},itemType:f.SONG,key:o});j(L)},500),w=R(d=>{var S;const L=c({customFilters:r,data:{_custom:{...t==null?void 0:t._custom,jellyfin:{...(S=t==null?void 0:t._custom)==null?void 0:S.jellyfin,IncludeItemTypes:"Audio"}},genreIds:d},itemType:f.SONG,key:o});j(L)},250),P=R(d=>{var S;const L=c({customFilters:r,data:{_custom:{...t==null?void 0:t._custom,jellyfin:{...(S=t==null?void 0:t._custom)==null?void 0:S.jellyfin,IncludeItemTypes:"Audio",Tags:(d==null?void 0:d.join("|"))||void 0}}},itemType:f.SONG,key:o});j(L)},250);return e.jsxs($,{p:"0.8rem",children:[b.map(d=>e.jsxs(N,{position:"apart",children:[e.jsx(ee,{children:d.label}),e.jsx(te,{checked:(d==null?void 0:d.value)||!1,onChange:d.onChange})]},`nd-filter-${d.label}`)),e.jsx(Y,{my:"0.5rem"}),e.jsxs(N,{grow:!0,children:[e.jsx(ne,{defaultValue:t==null?void 0:t.minYear,label:s("filter.fromYear",{postProcess:"sentenceCase"}),max:2300,min:1700,onChange:E,required:!!(t!=null&&t.minYear)}),e.jsx(ne,{defaultValue:t==null?void 0:t.maxYear,label:s("filter.toYear",{postProcess:"sentenceCase"}),max:2300,min:1700,onChange:F,required:!!(t!=null&&t.minYear)})]}),!u&&e.jsx(N,{grow:!0,children:e.jsx(Ce,{clearable:!0,data:a,defaultValue:A,label:s("entity.genre",{count:1,postProcess:"sentenceCase"}),onChange:w,searchable:!0,width:250})}),((H=(g=I.data)==null?void 0:g.boolTags)==null?void 0:H.length)&&e.jsx(N,{grow:!0,children:e.jsx(Ce,{clearable:!0,data:I.data.boolTags,defaultValue:h,label:s("common.tags",{postProcess:"sentenceCase"}),onChange:P,searchable:!0,width:250})})]})},Ct=({customFilters:r,onFilterChange:j,pageKey:o,serverId:l})=>{var F,w,P,k;const{t:s}=q(),{setFilter:c}=X(),t=Z({key:o}),u=(r==null?void 0:r.genreIds)!==void 0,p=se({query:{sortBy:K.NAME,sortOrder:m.ASC,startIndex:0},serverId:l}),a=be({query:{type:f.SONG},serverId:l}),I=T.useMemo(()=>p!=null&&p.data?p.data.items.map(i=>({label:i.name,value:i.id})):[],[p.data]),A=R(i=>{const O=c({customFilters:r,data:{_custom:t._custom,genreIds:i?[i]:void 0},itemType:f.SONG,key:o});j(O)},250),h=R((i,O)=>{var g;const _=c({customFilters:r,data:{_custom:{...t._custom,navidrome:{...(g=t._custom)==null?void 0:g.navidrome,[i]:O||void 0}}},itemType:f.SONG,key:o});j(_)},250),b=[{label:s("filter.isFavorited",{postProcess:"sentenceCase"}),onChange:i=>{const O=c({customFilters:r,data:{_custom:t._custom,favorite:i.currentTarget.checked?!0:void 0},itemType:f.SONG,key:o});j(O)},value:t.favorite}],E=R(i=>{var _;const O=c({customFilters:r,data:{_custom:{...t._custom,navidrome:{...(_=t._custom)==null?void 0:_.navidrome,year:i===""?void 0:i}}},itemType:f.SONG,key:o});j(O)},500);return e.jsxs($,{p:"0.8rem",children:[b.map(i=>e.jsxs(N,{position:"apart",children:[e.jsx(ee,{children:i.label}),e.jsx(te,{checked:(i==null?void 0:i.value)||!1,onChange:i.onChange,size:"xs"})]},`nd-filter-${i.label}`)),e.jsx(Y,{my:"0.5rem"}),e.jsxs(N,{grow:!0,children:[e.jsx(ne,{label:s("common.year",{postProcess:"titleCase"}),max:5e3,min:0,onChange:i=>E(i),value:(w=(F=t._custom)==null?void 0:F.navidrome)==null?void 0:w.year,width:50}),!u&&e.jsx(xe,{clearable:!0,data:I,defaultValue:t.genreIds?t.genreIds[0]:void 0,label:s("entity.genre",{count:1,postProcess:"titleCase"}),onChange:A,searchable:!0,width:150})]}),((k=(P=a.data)==null?void 0:P.enumTags)==null?void 0:k.length)&&a.data.enumTags.map(i=>{var O,_;return e.jsx(N,{grow:!0,children:e.jsx(xe,{clearable:!0,data:i.options,defaultValue:(_=(O=t._custom)==null?void 0:O.navidrome)==null?void 0:_[i.name],label:i.name,onChange:g=>h(i.name,g),searchable:!0,width:150})},i.name)})]})},xt=({customFilters:r,onFilterChange:j,pageKey:o,serverId:l})=>{const{t:s}=q(),{setFilter:c}=X(),t=Z({key:o}),u=(r==null?void 0:r.genreIds)!==void 0,p=se({query:{sortBy:K.NAME,sortOrder:m.ASC,startIndex:0},serverId:l}),a=T.useMemo(()=>p!=null&&p.data?p.data.items.map(h=>({label:h.name,value:h.id})):[],[p.data]),I=R(h=>{const b=c({customFilters:r,data:{genreIds:h?[h]:void 0},itemType:f.SONG,key:o});j(b)},250),A=[{disabled:t.genreIds!==void 0||u||!!t.searchTerm,label:s("filter.isFavorited",{postProcess:"sentenceCase"}),onChange:h=>{const b=c({customFilters:r,data:{favorite:h.target.checked},itemType:f.SONG,key:o});j(b)},value:t.favorite}];return e.jsxs($,{p:"0.8rem",children:[A.map(h=>e.jsxs(N,{position:"apart",children:[e.jsx(ee,{children:h.label}),e.jsx(te,{checked:(h==null?void 0:h.value)||!1,disabled:h.disabled,onChange:h.onChange,size:"xs"})]},`ss-filter-${h.label}`)),e.jsx(Y,{my:"0.5rem"}),e.jsx(N,{grow:!0,children:!u&&e.jsx(we,{clearable:!0,data:a,defaultValue:t.genreIds?t.genreIds[0]:void 0,disabled:!!t.searchTerm,label:s("entity.genre",{count:1,postProcess:"titleCase"}),onChange:I,searchable:!0,width:150})})]})},ae={jellyfin:[{defaultOrder:m.ASC,name:x.t("filter.album",{postProcess:"titleCase"}),value:C.ALBUM},{defaultOrder:m.ASC,name:x.t("filter.albumArtist",{postProcess:"titleCase"}),value:C.ALBUM_ARTIST},{defaultOrder:m.ASC,name:x.t("filter.artist",{postProcess:"titleCase"}),value:C.ARTIST},{defaultOrder:m.ASC,name:x.t("filter.duration",{postProcess:"titleCase"}),value:C.DURATION},{defaultOrder:m.ASC,name:x.t("filter.playCount",{postProcess:"titleCase"}),value:C.PLAY_COUNT},{defaultOrder:m.ASC,name:x.t("filter.name",{postProcess:"titleCase"}),value:C.NAME},{defaultOrder:m.ASC,name:x.t("filter.random",{postProcess:"titleCase"}),value:C.RANDOM},{defaultOrder:m.ASC,name:x.t("filter.recentlyAdded",{postProcess:"titleCase"}),value:C.RECENTLY_ADDED},{defaultOrder:m.ASC,name:x.t("filter.recentlyPlayed",{postProcess:"titleCase"}),value:C.RECENTLY_PLAYED},{defaultOrder:m.ASC,name:x.t("filter.releaseDate",{postProcess:"titleCase"}),value:C.RELEASE_DATE}],navidrome:[{defaultOrder:m.ASC,name:x.t("filter.album",{postProcess:"titleCase"}),value:C.ALBUM},{defaultOrder:m.ASC,name:x.t("filter.albumArtist",{postProcess:"titleCase"}),value:C.ALBUM_ARTIST},{defaultOrder:m.ASC,name:x.t("filter.artist",{postProcess:"titleCase"}),value:C.ARTIST},{defaultOrder:m.DESC,name:x.t("filter.bpm",{postProcess:"titleCase"}),value:C.BPM},{defaultOrder:m.ASC,name:x.t("common.channel",{count:2,postProcess:"titleCase"}),value:C.CHANNELS},{defaultOrder:m.ASC,name:x.t("filter.comment",{postProcess:"titleCase"}),value:C.COMMENT},{defaultOrder:m.DESC,name:x.t("filter.duration",{postProcess:"titleCase"}),value:C.DURATION},{defaultOrder:m.DESC,name:x.t("filter.isFavorited",{postProcess:"titleCase"}),value:C.FAVORITED},{defaultOrder:m.ASC,name:x.t("filter.genre",{postProcess:"titleCase"}),value:C.GENRE},{defaultOrder:m.ASC,name:x.t("filter.name",{postProcess:"titleCase"}),value:C.NAME},{defaultOrder:m.DESC,name:x.t("filter.playCount",{postProcess:"titleCase"}),value:C.PLAY_COUNT},{defaultOrder:m.ASC,name:x.t("filter.random",{postProcess:"titleCase"}),value:C.RANDOM},{defaultOrder:m.DESC,name:x.t("filter.rating",{postProcess:"titleCase"}),value:C.RATING},{defaultOrder:m.DESC,name:x.t("filter.recentlyAdded",{postProcess:"titleCase"}),value:C.RECENTLY_ADDED},{defaultOrder:m.DESC,name:x.t("filter.recentlyPlayed",{postProcess:"titleCase"}),value:C.RECENTLY_PLAYED},{defaultOrder:m.DESC,name:x.t("filter.releaseYear",{postProcess:"titleCase"}),value:C.YEAR}],subsonic:[{defaultOrder:m.ASC,name:x.t("filter.name",{postProcess:"titleCase"}),value:C.NAME}]},jt=({gridRef:r,itemCount:j,tableRef:o})=>{var ie,le,ce,de,ue;const{t:l}=q(),s=re(),{customFilters:c,handlePlay:t,pageKey:u}=ge(),{display:p,filter:a,grid:I,table:A}=Se({filter:c,key:u}),{setDisplayType:h,setFilter:b,setGrid:E,setTable:F,setTablePagination:w}=X(),{handleRefreshGrid:P,handleRefreshTable:k}=De({itemCount:j,itemType:f.SONG,server:s}),i=Te(),O=Ge({serverId:s==null?void 0:s.id}),_=(s==null?void 0:s.type)&&((ie=ae[s.type].find(n=>n.value===a.sortBy))==null?void 0:ie.name)||"Unknown",g=p===G.CARD||p===G.POSTER,H=T.useCallback(n=>{var B,M;if(!((B=n.currentTarget)!=null&&B.value)||!(s!=null&&s.type))return;const v=(M=ae[s.type].find(W=>W.value===n.currentTarget.value))==null?void 0:M.defaultOrder,D=b({customFilters:c,data:{sortBy:n.currentTarget.value,sortOrder:v||m.ASC},itemType:f.SONG,key:u});g?P(r,D):k(o,D)},[c,r,P,k,g,u,s==null?void 0:s.type,b,o]),d=T.useCallback(n=>{var D;if(!((D=n.currentTarget)!=null&&D.value))return;let v=null;n.currentTarget.value===String(a.musicFolderId)?v=b({customFilters:c,data:{musicFolderId:void 0},itemType:f.SONG,key:u}):v=b({customFilters:c,data:{musicFolderId:n.currentTarget.value},itemType:f.SONG,key:u}),g?P(r,v):k(o,v)},[a.musicFolderId,g,b,c,u,P,r,k,o]),L=T.useCallback(()=>{const n=a.sortOrder===m.ASC?m.DESC:m.ASC,v=b({customFilters:c,data:{sortOrder:n},itemType:f.SONG,key:u});g?P(r,v):k(o,v)},[c,a.sortOrder,r,P,k,g,u,b,o]),S=T.useCallback(n=>{var D,B;if(!((D=n.currentTarget)!=null&&D.value))return;const v=n.currentTarget.value;h({data:n.currentTarget.value,key:u}),v===G.TABLE?((B=o.current)==null||B.api.paginationSetPageSize(o.current.props.infiniteInitialRowCount),w({data:{currentPage:0},key:u})):v===G.TABLE_PAGINATED&&w({data:{currentPage:0},key:u})},[u,h,w,o]),Oe=n=>{const v=A.columns;if(n.length===0)return F({data:{columns:[]},key:u});if(n.length>v.length){const M={column:n[n.length-1],width:100};return F({data:{columns:[...v,M]},key:u})}const D=v.filter(M=>!n.includes(M.column)),B=v.filter(M=>!D.includes(M));return F({data:{columns:B},key:u})},Ie=n=>{var v;F({data:{autoFit:n.currentTarget.checked},key:u}),n.currentTarget.checked&&((v=o.current)==null||v.api.sizeColumnsToFit())},ke=n=>{g?E({data:{itemSize:n},key:u}):F({data:{rowHeight:n},key:u})},Pe=n=>{E({data:{itemGap:n},key:u})},oe=()=>{Qe.invalidateQueries(Ae.songs.list((s==null?void 0:s.id)||"")),g?P(r,a):k(o,a)},Le=n=>{g?P(r,{...n}):k(o,{...n})},Ee=()=>{let n;switch(s==null?void 0:s.type){case z.JELLYFIN:n=ht;break;case z.NAVIDROME:n=Ct;break;case z.SUBSONIC:n=xt;break}n&&Je({children:e.jsx(n,{customFilters:c,onFilterChange:Le,pageKey:u,serverId:s==null?void 0:s.id}),title:"Song Filters"})},Fe=T.useMemo(()=>{var B,M,W,me,pe;const n=(s==null?void 0:s.type)===z.NAVIDROME&&((B=a._custom)==null?void 0:B.navidrome)&&Object.values((M=a==null?void 0:a._custom)==null?void 0:M.navidrome).some(U=>U!==void 0),v=(s==null?void 0:s.type)===z.JELLYFIN&&((W=a==null?void 0:a._custom)==null?void 0:W.jellyfin)&&Object.values((me=a==null?void 0:a._custom)==null?void 0:me.jellyfin).filter(U=>U!=="Audio").some(U=>U!==void 0),D=(a==null?void 0:a.favorite)||((pe=a==null?void 0:a.genreIds)==null?void 0:pe.length);return n||v||D},[(le=a._custom)==null?void 0:le.jellyfin,(ce=a._custom)==null?void 0:ce.navidrome,a==null?void 0:a.favorite,(de=a==null?void 0:a.genreIds)==null?void 0:de.length,s==null?void 0:s.type]),_e=T.useMemo(()=>a.musicFolderId!==void 0,[a.musicFolderId]);return e.jsxs(fe,{justify:"space-between",children:[e.jsxs(N,{ref:i.ref,spacing:"sm",w:"100%",children:[e.jsxs(y,{position:"bottom-start",children:[e.jsx(y.Target,{children:e.jsx(V,{compact:!0,fw:"600",size:"md",variant:"subtle",children:_})}),e.jsx(y.Dropdown,{children:ae[s==null?void 0:s.type].map(n=>e.jsx(y.Item,{$isActive:n.value===a.sortBy,onClick:H,value:n.value,children:n.name},`filter-${n.name}`))})]}),(s==null?void 0:s.type)!==z.SUBSONIC&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{orientation:"vertical"}),e.jsx(Me,{onToggle:L,sortOrder:a.sortOrder})]}),(s==null?void 0:s.type)===z.JELLYFIN&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{orientation:"vertical"}),e.jsxs(y,{position:"bottom-start",children:[e.jsx(y.Target,{children:e.jsx(V,{compact:!0,fw:"600",size:"md",sx:{svg:{fill:_e?"var(--primary-color) !important":void 0}},variant:"subtle",children:e.jsx(Be,{size:"1.3rem"})})}),e.jsx(y.Dropdown,{children:(ue=O.data)==null?void 0:ue.items.map(n=>e.jsx(y.Item,{$isActive:a.musicFolderId===n.id,onClick:d,value:n.id,children:n.name},`musicFolder-${n.id}`))})]})]}),e.jsx(Y,{orientation:"vertical"}),e.jsx(V,{compact:!0,onClick:Ee,size:"md",sx:{svg:{fill:Fe?"var(--primary-color) !important":void 0}},tooltip:{label:l("common.filters",{postProcess:"titleCase"})},variant:"subtle",children:e.jsx(Re,{size:"1.3rem"})}),e.jsx(Y,{orientation:"vertical"}),e.jsx(V,{compact:!0,onClick:oe,size:"md",tooltip:{label:l("common.refresh",{postProcess:"titleCase"})},variant:"subtle",children:e.jsx(ye,{size:"1.3rem"})}),e.jsx(Y,{orientation:"vertical"}),e.jsxs(y,{position:"bottom-start",children:[e.jsx(y.Target,{children:e.jsx(V,{compact:!0,fw:"600",size:"md",variant:"subtle",children:e.jsx(Ye,{size:"1.3rem"})})}),e.jsxs(y.Dropdown,{children:[e.jsx(y.Item,{icon:e.jsx(ze,{}),onClick:()=>t==null?void 0:t({playType:J.NOW}),children:l("player.play",{postProcess:"sentenceCase"})}),e.jsx(y.Item,{icon:e.jsx(Ve,{}),onClick:()=>t==null?void 0:t({playType:J.SHUFFLE}),children:l("player.shuffle",{postProcess:"sentenceCase"})}),e.jsx(y.Item,{icon:e.jsx(qe,{}),onClick:()=>t==null?void 0:t({playType:J.LAST}),children:l("player.addLast",{postProcess:"sentenceCase"})}),e.jsx(y.Item,{icon:e.jsx(Ue,{}),onClick:()=>t==null?void 0:t({playType:J.NEXT}),children:l("player.addNext",{postProcess:"sentenceCase"})}),e.jsx(y.Divider,{}),e.jsx(y.Item,{icon:e.jsx(ye,{}),onClick:oe,children:l("common.refresh",{postProcess:"titleCase"})})]})]})]}),e.jsx(N,{noWrap:!0,spacing:"sm",children:e.jsxs(y,{position:"bottom-end",width:425,children:[e.jsx(y.Target,{children:e.jsx(V,{compact:!0,size:"md",variant:"subtle",children:e.jsx($e,{size:"1.3rem"})})}),e.jsxs(y.Dropdown,{children:[e.jsx(y.Label,{children:l("table.config.general.displayType",{postProcess:"sentenceCase"})}),e.jsx(y.Item,{$isActive:p===G.CARD,onClick:S,value:G.CARD,children:l("table.config.view.card",{postProcess:"sentenceCase"})}),e.jsx(y.Item,{$isActive:p===G.POSTER,onClick:S,value:G.POSTER,children:l("table.config.view.poster",{postProcess:"sentenceCase"})}),e.jsx(y.Item,{$isActive:p===G.TABLE,onClick:S,value:G.TABLE,children:l("table.config.view.table",{postProcess:"sentenceCase"})}),e.jsx(y.Divider,{}),e.jsx(y.Label,{children:l("table.config.general.size",{postProcess:"sentenceCase"})}),e.jsx(y.Item,{closeMenuOnClick:!1,children:e.jsx(he,{defaultValue:g?(I==null?void 0:I.itemSize)||0:A.rowHeight,max:g?300:100,min:g?100:25,onChangeEnd:ke})}),g&&e.jsxs(e.Fragment,{children:[e.jsx(y.Label,{children:l("table.config.general.gap",{postProcess:"sentenceCase"})}),e.jsx(y.Item,{closeMenuOnClick:!1,children:e.jsx(he,{defaultValue:(I==null?void 0:I.itemGap)||0,max:30,min:0,onChangeEnd:Pe})})]}),e.jsx(y.Label,{children:l("table.config.general.tableColumns",{postProcess:"sentenceCase"})}),e.jsx(y.Item,{closeMenuOnClick:!1,component:"div",sx:{cursor:"default"},children:e.jsxs($,{children:[e.jsx(He,{clearable:!0,data:We,defaultValue:A==null?void 0:A.columns.map(n=>n.column),onChange:Oe,width:300}),e.jsxs(N,{position:"apart",children:[e.jsx(ee,{children:l("table.config.general.autoFitColumns",{postProcess:"sentenceCase"})}),e.jsx(te,{defaultChecked:A.autoFit,onChange:Ie})]})]})})]})]})})]})},gt=({genreId:r,gridRef:j,itemCount:o,tableRef:l,title:s})=>{const{t:c}=q(),t=re(),u=Te(),p=T.useRef(void 0),{customFilters:a,filter:I,handlePlay:A,refresh:h,search:b}=Xe({gridRef:j,itemCount:o,itemType:f.SONG,server:t,tableRef:l}),E=R(w=>{const k={...b(w),...a};h(k)},500);T.useEffect(()=>{p.current&&p.current!==r&&h(a),p.current=r},[a,r,h,l]);const F=Ze();return e.jsxs($,{ref:u.ref,spacing:0,children:[e.jsx(Ke,{backgroundColor:"var(--titlebar-bg)",children:e.jsxs(fe,{justify:"space-between",w:"100%",children:[e.jsxs(Q,{children:[e.jsx(Q.PlayButton,{onClick:()=>A==null?void 0:A({playType:F})}),e.jsx(Q.Title,{children:s||c("page.trackList.title",{postProcess:"titleCase"})}),e.jsx(Q.Badge,{isLoading:o==null,children:o})]}),e.jsx(N,{children:e.jsx(et,{defaultValue:I.searchTerm,onChange:E,openedWidth:u.isMd?250:u.isSm?200:150})})]})}),e.jsx(tt,{children:e.jsx(jt,{gridRef:j,itemCount:o,tableRef:l})})]})},St=r=>{const{options:j,query:o,serverId:l}=r,s=st(l);return at({enabled:!!l,queryFn:({signal:c})=>{if(!s)throw new Error("Server not found");return nt.controller.getSongListCount({apiClientProps:{server:s,signal:c},query:o})},queryKey:Ae.songs.count(l||"",Object.keys(o).length===0?void 0:o),...j})},At=()=>{const{t:r}=q(),j=T.useRef(null),o=T.useRef(null),l=re(),[s]=rt(),{albumArtistId:c,genreId:t}=ot(),u=c?"albumArtistSong":"song",p=T.useMemo(()=>{const i={...c&&{artistIds:[c]},...t&&{genreIds:[t]}};if(!ut(i))return i},[c,t]),a=it(),I=Z({filter:p,key:u}),A=se({options:{cacheTime:1e3*60*60,enabled:!!t},query:{sortBy:K.NAME,sortOrder:m.ASC,startIndex:0},serverId:l==null?void 0:l.id}),h=T.useMemo(()=>{if(!A.data)return"";const i=A.data.items.find(O=>O.id===t);return i?i==null?void 0:i.name:"Unknown"},[t,A.data]),b=St({options:{cacheTime:1e3*60,staleTime:1e3*60},query:I,serverId:l==null?void 0:l.id}),E=b.data===null?void 0:b.data,F=T.useCallback(async i=>{if(!E||E===0)return;const{initialSongId:O,playType:_}=i,g={...I,limit:E,startIndex:0};c?a==null||a({byItemType:{id:[c],type:f.ALBUM_ARTIST},initialSongId:O,playType:_,query:g}):a==null||a({byItemType:{id:[],type:f.SONG},initialSongId:O,playType:_,query:g})},[c,a,E,I]),w=T.useMemo(()=>({customFilters:p,handlePlay:F,id:c??t,pageKey:u}),[c,p,t,F,u]),P=s.get("artistName"),k=P?je(r("page.trackList.artistTracks",{artist:P})):t?je(r("page.trackList.genreTracks",{genre:lt(h)})):void 0;return e.jsx(ct,{children:e.jsxs(dt.Provider,{value:w,children:[e.jsx(gt,{genreId:t,gridRef:j,itemCount:E,tableRef:o,title:k}),e.jsx(yt,{gridRef:j,itemCount:E,tableRef:o})]})})};export{At as default};
//# sourceMappingURL=song-list-route-BdnaY4np.js.map
